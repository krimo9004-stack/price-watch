<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Price Watch | Live Global Markets</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#0f172a;color:#fff;}
header{padding:20px;text-align:center;font-size:26px;font-weight:bold;background:#020617;}
.tabs{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;background:#020617;padding:10px;}
.tab{padding:8px 14px;border-radius:6px;border:none;cursor:pointer;background:#1e293b;color:#fff;}
.tab.active{background:#38bdf8;color:#000;}
.section{display:none;padding:20px;}
.section.active{display:block;}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid #1e293b;text-align:left;}
th{color:#38bdf8;}
.search{margin:15px auto;display:block;width:300px;padding:10px;border-radius:6px;border:none;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:20px;}
.box{background:#020617;border-radius:14px;height:450px;position:relative;overflow:hidden;}
iframe{width:100%;height:100%;border:none;}
.full{
  position:absolute;
  top:10px;
  right:calc(10px + 3cm);
  padding:6px;
  border:none;
  border-radius:5px;
  background:#38bdf8;
  cursor:pointer;
  z-index:10;
  transition: all 0.3s ease;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LBESTBMXTK"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LBESTBMXTK');
</script>
</head>
<body>

<header>ðŸ“Š Price Watch â€“ Live Global Markets</header>

<div class="tabs">
  <button class="tab active" data-tab="crypto">Crypto (Live)</button>
  <button class="tab" data-tab="forex">Forex (Live)</button>
  <button class="tab" data-tab="markets">Markets</button>
</div>

<input class="search" id="search" placeholder="Search...">

<!-- CRYPTO -->
<div class="section active" id="crypto">
  <table id="cryptoTable">
    <tr><th>Coin</th><th>Price (USD)</th><th>24h %</th></tr>
  </table>
</div>

<!-- FOREX -->
<div class="section" id="forex">
  <table id="forexTable">
    <tr><th>Pair</th><th>Rate</th></tr>
  </table>
</div>

<!-- MARKETS -->
<div class="section" id="markets">
  <div class="grid">
    <div class="box">
      <button class="full">â›¶</button>
      <iframe src="https://s.tradingview.com/widgetembed/?symbol=TVC:GOLD&interval=60&theme=Dark"></iframe>
    </div>
    <div class="box">
      <button class="full">â›¶</button>
      <iframe src="https://s.tradingview.com/widgetembed/?symbol=TVC:USOIL&interval=60&theme=Dark"></iframe>
    </div>
    <div class="box">
      <button class="full">â›¶</button>
      <iframe src="https://s.tradingview.com/widgetembed/?symbol=SP:SPX&interval=60&theme=Dark"></iframe>
    </div>
  </div>
</div>

<!-- Adsterra Popunder -->
<script src="https://pl28518850.effectivegatecpm.com/8a/e1/00/8ae100f959f39f1b1e274db5a9efd123.js"></script>

<script>
// Tabs
document.querySelectorAll(".tab").forEach(b=>{
  b.onclick=()=> {
    document.querySelectorAll(".tab,.section").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    document.getElementById(b.dataset.tab).classList.add("active");
  }
});

// Fullscreen buttons + dynamic color
document.querySelectorAll(".full").forEach(btn=>{
  btn.addEventListener("click", function(){
    const chartBox = this.parentElement;
    if(!document.fullscreenElement){
      chartBox.requestFullscreen().catch(err=>{
        alert("Fullscreen failed: " + err.message);
      });
    } else {
      document.exitFullscreen();
    }
  });
  // Dynamic color based on body background
  const updateColor = () => {
    let bg = window.getComputedStyle(document.body).backgroundColor;
    const brightness = (c) => {
      const rgb = c.match(/\d+/g);
      return (parseInt(rgb[0])*299 + parseInt(rgb[1])*587 + parseInt(rgb[2])*114)/1000;
    };
    btn.style.background = brightness(bg) < 128 ? "#38bdf8" : "#0f172a";
    btn.style.color = brightness(bg) < 128 ? "#000" : "#fff";
  };
  updateColor();
});

// CRYPTO LIVE
async function loadCrypto(){
  let coins=["bitcoin","ethereum","bnb","ripple","cardano","dogecoin","solana","polkadot"];
  let r=await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coins.join(",")}&vs_currencies=usd&include_24hr_change=true`);
  let d=await r.json();
  let t=document.getElementById("cryptoTable");
  t.innerHTML="<tr><th>Coin</th><th>Price</th><th>24h%</th></tr>";
  for(let c in d){
    t.innerHTML+=`<tr><td>${c}</td><td>$${d[c].usd}</td><td>${d[c].usd_24h_change.toFixed(2)}%</td></tr>`;
  }
}
loadCrypto(); setInterval(loadCrypto,30000);

// FOREX LIVE
async function loadForex(){
  let r=await fetch("https://api.exchangerate.host/latest?base=USD");
  let d=await r.json();
  let pairs=["EUR","GBP","JPY","AUD","CAD","CHF"];
  let t=document.getElementById("forexTable");
  t.innerHTML="<tr><th>Pair</th><th>Rate</th></tr>";
  pairs.forEach(p=>{
    t.innerHTML+=`<tr><td>USD/${p}</td><td>${d.rates[p]}</td></tr>`;
  });
}
loadForex(); setInterval(loadForex,60000);

// Search filter
document.getElementById("search").addEventListener("input", function(){
  let val=this.value.toLowerCase();
  document.querySelectorAll("#cryptoTable tr,#forexTable tr").forEach(tr=>{
    if(tr.querySelector("td")){
      tr.style.display = Array.from(tr.querySelectorAll("td")).some(td=>td.textContent.toLowerCase().includes(val)) ? "table-row" : "none";
    }
  });
});
</script>
</body>
</html>
